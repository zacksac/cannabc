{"version":3,"file":"theme-bundle.chunk.471.js","mappings":"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","sources":["webpack://bigcommerce-hera/./assets/js/theme/search.js"],"sourcesContent":["import { hooks, api } from '@bigcommerce/stencil-utils';\nimport CatalogPage from './catalog';\nimport utils from '@bigcommerce/stencil-utils';\nimport FacetedSearch from './common/faceted-search';\nimport { announceInputErrorMessage } from './common/utils/form-utils';\nimport compareProducts from './global/compare-products';\nimport urlUtils from './common/utils/url-utils';\nimport Url from 'url';\nimport collapsibleFactory from './common/collapsible';\nimport 'jstree';\nimport nod from './common/nod';\nimport haloSideAllCategory from './halothemes/haloSideAllCategory';\nimport haloAddOptionForProduct from './halothemes/haloAddOptionForProduct';\nimport haloproductDisplayMode from './halothemes/haloProductDisplayMode';\nimport haloSidebarToggle from './halothemes/haloSidebarToggle';\nimport haloStickyToolbar from './halothemes/haloStickyToolbar';\n\nconst leftArrowKey = 37;\nconst rightArrowKey = 39;\n\nexport default class Search extends CatalogPage {\n    formatCategoryTreeForJSTree(node) {\n        const nodeData = {\n            text: node.data,\n            id: node.metadata.id,\n            state: {\n                selected: node.selected,\n            },\n        };\n\n        if (node.state) {\n            nodeData.state.opened = node.state === 'open';\n            nodeData.children = true;\n        }\n\n        if (node.children) {\n            nodeData.children = [];\n            node.children.forEach((childNode) => {\n                nodeData.children.push(this.formatCategoryTreeForJSTree(childNode));\n            });\n        }\n\n        return nodeData;\n    }\n\n    showProducts(navigate = true) {\n        this.$productListingContainer.removeClass('u-hidden');\n        this.$facetedSearchContainer.removeClass('u-hidden');\n        this.$contentResultsContainer.addClass('u-hidden');\n\n        $('[data-content-results-toggle]').removeClass('navBar-action-color--active').addClass('navBar-action');\n        $('[data-product-results-toggle]').removeClass('navBar-action').addClass('navBar-action-color--active');\n        $('[data-product-results-toggle]').parent('.navBar-item').addClass('navBar-item--active');\n        $('[data-product-results-toggle]').parent('.navBar-item').siblings().removeClass('navBar-item--active');\n\n        this.activateTab($('[data-product-results-toggle]'));\n\n        if (!navigate) {\n            return;\n        }\n\n        const searchData = $('#search-results-product-count span').data();\n        const url = (searchData.count > 0) ? searchData.url : urlUtils.replaceParams(searchData.url, {\n            page: 1,\n        });\n\n        urlUtils.goToUrl(url);\n    }\n\n    showContent(navigate = true) {\n        this.$contentResultsContainer.removeClass('u-hidden');\n        this.$productListingContainer.addClass('u-hidden');\n        this.$facetedSearchContainer.addClass('u-hidden');\n\n        $('[data-product-results-toggle]').removeClass('navBar-action-color--active').addClass('navBar-action');\n        $('[data-content-results-toggle]').removeClass('navBar-action').addClass('navBar-action-color--active');\n        $('[data-content-results-toggle]').parent('.navBar-item').addClass('navBar-item--active');\n        $('[data-content-results-toggle]').parent('.navBar-item').siblings().removeClass('navBar-item--active');\n\n        this.activateTab($('[data-content-results-toggle]'));\n\n        if (!navigate) {\n            return;\n        }\n\n        const searchData = $('#search-results-content-count span').data();\n        const url = (searchData.count > 0) ? searchData.url : urlUtils.replaceParams(searchData.url, {\n            page: 1,\n        });\n\n        urlUtils.goToUrl(url);\n    }\n\n    activateTab($tabToActivate) {\n        const $tabsCollection = $('[data-search-page-tabs]').find('[role=\"tab\"]');\n\n        $tabsCollection.each((idx, tab) => {\n            const $tab = $(tab);\n\n            if ($tab.is($tabToActivate)) {\n                $tab.removeAttr('tabindex');\n                $tab.attr('aria-selected', true);\n                return;\n            }\n\n            $tab.attr('tabindex', '-1');\n            $tab.attr('aria-selected', false);\n        });\n    }\n\n    onTabChangeWithArrows(event) {\n        const eventKey = event.which;\n        const isLeftOrRightArrowKeydown = eventKey === leftArrowKey\n            || eventKey === rightArrowKey;\n        if (!isLeftOrRightArrowKeydown) return;\n\n        const $tabsCollection = $('[data-search-page-tabs]').find('[role=\"tab\"]');\n\n        const isActiveElementNotTab = $tabsCollection.index($(document.activeElement)) === -1;\n        if (isActiveElementNotTab) return;\n\n        const $activeTab = $(`#${document.activeElement.id}`);\n        const activeTabIdx = $tabsCollection.index($activeTab);\n        const lastTabIdx = $tabsCollection.length - 1;\n\n        let nextTabIdx;\n        switch (eventKey) {\n        case leftArrowKey:\n            nextTabIdx = activeTabIdx === 0 ? lastTabIdx : activeTabIdx - 1;\n            break;\n        case rightArrowKey:\n            nextTabIdx = activeTabIdx === lastTabIdx ? 0 : activeTabIdx + 1;\n            break;\n        default: break;\n        }\n\n        $($tabsCollection.get(nextTabIdx)).focus().trigger('click');\n    }\n\n    onReady() {\n        compareProducts(this.context);\n        this.arrangeFocusOnSortBy();\n\n        const $searchForm = $('[data-advanced-search-form]');\n        const $categoryTreeContainer = $searchForm.find('[data-search-category-tree]');\n        const url = Url.parse(window.location.href, true);\n        const treeData = [];\n        this.$productListingContainer = $('#product-listing-container');\n        this.$facetedSearchContainer = $('#faceted-search-container');\n        this.$contentResultsContainer = $('#search-results-content');\n\n        // Init faceted search\n        if ($('#facetedSearch').length > 0) {\n            this.initFacetedSearch();\n        } else {\n            this.onSortBySubmit = this.onSortBySubmit.bind(this);\n            hooks.on('sortBy-submitted', this.onSortBySubmit);\n        }\n\n        // Init collapsibles\n        collapsibleFactory();\n\n        $('[data-product-results-toggle]').on('click', event => {\n            event.preventDefault();\n            this.showProducts();\n        });\n\n        $('[data-content-results-toggle]').on('click', event => {\n            event.preventDefault();\n            this.showContent();\n        });\n\n        $('[data-search-page-tabs]').on('keyup', this.onTabChangeWithArrows);\n\n        if (this.$productListingContainer.find('li.product').length === 0 || url.query.section === 'content') {\n            this.showContent(false);\n        } else {\n            this.showProducts(false);\n        }\n\n        const validator = this.initValidation($searchForm)\n            .bindValidation($searchForm.find('#search_query_adv'));\n\n        this.context.categoryTree.forEach((node) => {\n            treeData.push(this.formatCategoryTreeForJSTree(node));\n        });\n\n        this.categoryTreeData = treeData;\n        this.createCategoryTree($categoryTreeContainer);\n\n        $searchForm.on('submit', event => {\n            const selectedCategoryIds = $categoryTreeContainer.jstree().get_selected();\n\n            if (!validator.check()) {\n                return event.preventDefault();\n            }\n\n            $searchForm.find('input[name=\"category\\[\\]\"]').remove();\n\n            for (const categoryId of selectedCategoryIds) {\n                const input = $('<input>', {\n                    type: 'hidden',\n                    name: 'category[]',\n                    value: categoryId,\n                });\n\n                $searchForm.append(input);\n            }\n        });\n\n        const $searchResultsMessage = $(`<p\n            class=\"aria-description--hidden\"\n            tabindex=\"-1\"\n            role=\"status\"\n            aria-live=\"polite\"\n            >${this.context.searchResultsCount}</p>`)\n            .prependTo('body');\n\n        setTimeout(() => $searchResultsMessage.focus(), 100);\n\n        haloSideAllCategory();\n        haloproductDisplayMode();\n        haloSidebarToggle();\n        haloStickyToolbar(this.context);\n        this.loadProductByCategory();\n        this.loadProductByEditorPick();\n        this.loadOptionForProductCard(this.context);\n        this.showProductsPerPage();\n        this.showMoreProducts();\n        this.showPaginationInfoToolbar();\n        this.showItem();\n    }\n\n    loadTreeNodes(node, cb) {\n        $.ajax({\n            url: '/remote/v1/category-tree',\n            data: {\n                selectedCategoryId: node.id,\n                prefix: 'category',\n            },\n            headers: {\n                'x-xsrf-token': window.BCData && window.BCData.csrf_token ? window.BCData.csrf_token : '',\n            },\n        }).done(data => {\n            const formattedResults = [];\n\n            data.forEach((dataNode) => {\n                formattedResults.push(this.formatCategoryTreeForJSTree(dataNode));\n            });\n\n            cb(formattedResults);\n        });\n    }\n\n    createCategoryTree($container) {\n        const treeOptions = {\n            core: {\n                data: (node, cb) => {\n                    // Root node\n                    if (node.id === '#') {\n                        cb(this.categoryTreeData);\n                    } else {\n                        // Lazy loaded children\n                        this.loadTreeNodes(node, cb);\n                    }\n                },\n                themes: {\n                    icons: true,\n                },\n            },\n            checkbox: {\n                three_state: false,\n            },\n            plugins: [\n                'checkbox',\n            ],\n        };\n\n        $container.jstree(treeOptions);\n    }\n\n    initFacetedSearch() {\n        // eslint-disable-next-line object-curly-newline\n        const { onMinPriceError, onMaxPriceError, minPriceNotEntered, maxPriceNotEntered, onInvalidPrice } = this.context;\n        const $productListingContainer = $('#product-listing-container');\n        const $contentListingContainer = $('#search-results-content');\n        const $facetedSearchContainer = $('#faceted-search-container');\n        const $searchHeading = $('#search-results-heading');\n        const $searchCount = $('#search-results-product-count');\n        const $contentCount = $('#search-results-content-count');\n        const $showMoreContainer = $('.halo-product-show-more');\n        const productsPerPage = this.context.searchProductsPerPage;\n        const requestOptions = {\n            template: {\n                productListing: 'search/product-listing',\n                contentListing: 'search/content-listing',\n                sidebar: 'search/sidebar',\n                heading: 'search/heading',\n                productCount: 'search/product-count',\n                contentCount: 'search/content-count',\n                paginator: 'halothemes/gallery/halo-product-paginator'\n            },\n            config: {\n                product_results: {\n                    limit: productsPerPage,\n                },\n            },\n            showMore: 'search/show-more',\n        };\n\n        this.facetedSearch = new FacetedSearch(requestOptions, (content) => {\n            $searchHeading.html(content.heading);\n\n            const url = Url.parse(window.location.href, true);\n            if (url.query.section === 'content') {\n                $contentListingContainer.html(content.contentListing);\n                $contentCount.html(content.contentCount);\n                this.showContent(false);\n            } else {\n                $productListingContainer.find('.product-listing-content').html(content.productListing);\n                $facetedSearchContainer.html(content.sidebar);\n                $searchCount.html(content.productCount);\n                $showMoreContainer.html($(content.paginator).find('.halo-product-show-more').children());\n                \n                this.showProducts(false);\n                this.showProductsPerPage();\n                this.showMoreProducts();\n                this.showPaginationInfoToolbar();\n                this.showItem();\n\n                if($('#product-listing-container .product').length > 0){\n                    haloAddOptionForProduct(this.context, 'product-listing-container');\n                }\n            }\n\n            $('body').triggerHandler('compareReset');\n\n            $('html, body').animate({\n                scrollTop: 0,\n            }, 100);\n\n            const $topProduct = $('#faceted-search-container #featured-products .products-list');\n\n            if ($topProduct.length) {\n                $topProduct.slick();\n            }\n        }, {\n            validationErrorMessages: {\n                onMinPriceError,\n                onMaxPriceError,\n                minPriceNotEntered,\n                maxPriceNotEntered,\n                onInvalidPrice,\n            },\n        });\n    }\n\n    loadOptionForProductCard(context){\n        if($('#featured-products .card').length > 0){\n            haloAddOptionForProduct(context, 'featured-products');\n        }\n\n        if($('#product-listing-container .product').length > 0){\n            haloAddOptionForProduct(context, 'product-listing-container');\n        }\n    }\n\n    showProductsPerPage(){\n        try {\n            var url = new URL(window.location.href);\n            var c = url.searchParams.get(\"limit\");\n            if(c != null){\n                var limit = document.querySelectorAll('select#limit option');\n                Array.prototype.forEach.call(limit, function(element) {\n                    if(element.value == c){\n                        element.selected = true;\n                    }\n                });\n            }\n        } catch(e) {}\n    }\n\n    showItem() {\n        var total = parseInt($('.pagination-info .total').text()),\n            limit = this.getUrlParameter('limit'),\n            productPerPage;\n\n        if (limit !== undefined) {\n            productPerPage = limit;\n        } else{\n            productPerPage = this.context.searchProductsPerPage;\n        }\n\n        var start = 1,\n            end = total,\n            checkLastPage = false,\n            lastPage = 1;\n            \n        var checkLink = $(\".pagination-list .pagination-item--current\").next();\n        var pageNotLast = lastPage - 1;\n        var totalNotLast = pageNotLast * productPerPage;\n        var productsLastPage = total - totalNotLast;\n        var currentPage = parseInt($('.pagination-item--current > a').text());\n        var prevPage = currentPage - 1;\n\n        if (checkLink.length === 0) {\n            lastPage = parseInt($(\".pagination-item--current\").find(\"a\").text());\n            checkLastPage = true;\n        } else {\n            lastPage = parseInt(checkLink.find(\"a\").text());\n            checkLastPage = false;\n        }\n        \n        if (total <= productPerPage) {\n            $('.pagination-info .start').text(start);\n            $('.pagination-info .end').text(end);\n        } else {\n            if (currentPage <= 1) {\n                end = productPerPage;\n            } else {\n                start = (prevPage * productPerPage) + 1;\n                \n                if (checkLastPage == true) {\n                    if($('.pagination-list .pagination-item--next').length > 0){\n                        end = totalNotLast + productsLastPage - 1;\n                    } else{\n                        end = totalNotLast + productsLastPage;\n                    }\n                } else {\n                    end = currentPage * productPerPage;\n                }\n            }\n\n            $('.pagination-info .start').text(start);\n            $('.pagination-info .end').text(end);\n        }\n\n        this.showPaginationTotalProgress();\n    }\n\n    getUrlParameter(sParam) {\n        var sPageURL = decodeURIComponent(window.location.search.substring(1)),\n            sURLVariables = sPageURL.split('&'),\n            sParameterName,\n            i;\n\n        for (i = 0; i < sURLVariables.length; i++) {\n            sParameterName = sURLVariables[i].split('=');\n\n            if (sParameterName[0] === sParam) {\n                return sParameterName[1] === undefined ? true : sParameterName[1];\n            }\n        }\n    }\n\n    showMoreProducts() {\n        const context = this.context;\n        const getUrlParameter = this.getUrlParameter('limit');\n        const requestOptions = {\n            config: {\n                product_results: {\n                    shop_by_price: true,\n                    products: {\n                        limit: context.searchProductsPerPage,\n                    },\n                },\n            },\n            template: {\n                productListing: 'search/halo-product-listing',\n                sidebar: 'search/sidebar',\n                paginator: 'halothemes/gallery/halo-product-paginator',\n            },\n            showMore: 'search/show-more',\n        };\n\n        const $productListingContainer = $('#product-listing-container .productListing');\n        const $facetedSearchContainer = $('#faceted-search-container');\n        const $paginatorContainer = $('.pagination-list');\n        const $showMoreContainer = $('.halo-product-show-more');\n\n        $('#listing-showmoreBtn > a').on('click', (event) => {\n            event.preventDefault();\n\n            var nextPage = $('.pagination-item--current').next(),\n                link = nextPage.find('a').attr('href');\n\n            if (link == undefined) {\n                if (!$('#listing-showmoreBtn > a').hasClass('disable')) {\n                    $('#listing-showmoreBtn > a').addClass('disable');\n                }\n            } else {\n                $('#listing-showmoreBtn > a').addClass('loading');\n\n                api.getPage(link.replace(\"http://\", \"//\"), requestOptions, (err, content) => {\n                    if (err) {\n                        throw new Error(err);\n                    }\n\n                    if (content.productListing != '') {\n                        $productListingContainer.append(content.productListing);\n                        $paginatorContainer.html($(content.paginator).find('.pagination-list').children());\n\n                        $('#listing-showmoreBtn > a').removeClass('loading').blur();\n\n                        nextPage = $('.pagination-item--current').next();\n\n                        if (nextPage.length === 0) {\n                            $('#listing-showmoreBtn > a').addClass('disable').text('No more products');\n                            $('.pagination .pagination-info .end').text($('.toolbar-left .pagination-info .total').text());\n                        } else {\n                            var limit = getUrlParameter,\n                                productPerPage,\n                                pageCurrent = parseInt($('.pagination-item--current > a').text());\n\n                            if (limit !== undefined) {\n                                productPerPage = limit;\n                            } else{\n                                productPerPage = context.searchProductsPerPage;\n                            }\n\n                            var total = parseInt(productPerPage)*pageCurrent;\n\n                            $('.pagination .pagination-info .end').text(total);\n                        }\n\n                        var paginationInfo = $('.pagination .pagination-info').html(),\n                        toolbarPaginationInfo = $('.toolbar-wrapper .toolbar-left .pagination-info');\n                        toolbarPaginationInfo.html(paginationInfo);\n\n                        this.showPaginationTotalProgress();\n\n                        haloAddOptionForProduct(context, 'product-listing-container');\n                    }\n                });\n            }\n        });\n    }\n\n    showPaginationTotalProgress() {\n        const txt_end = $('.pagination-info .end').text(),\n            txt_total = $('.pagination-info .total').text(),\n            num_end = (num_end != '' ? Number(txt_end.replace(/[^0-9.-]+/g,'')) : 0),\n            num_total = (num_total != '' ? Number(txt_total.replace(/[^0-9.-]+/g,'')) : 0);\n\n        var percent = parseInt(num_end/num_total * 100);\n        \n        percent = (percent > 100 ? 100 : percent);\n\n        if(num_end == num_total){\n            percent = 100;\n        }\n\n        $('.pagination-total-progress .pagination-total-item').css('width', percent + '%');\n    }\n\n    showPaginationInfoToolbar() {\n        var paginationInfo = $('.pagination .pagination-info').html(),\n            toolbarPaginationInfo = $('.toolbar-wrapper .toolbar-left .pagination-info');\n\n        toolbarPaginationInfo.html(paginationInfo);\n    }\n\n    loadProductByCategory(){\n        const context = this.context;\n\n        var $options;\n\n        if($('.sidebarBlock[data-category-id]').length > 0){\n            $('.sidebarBlock[data-category-id]').each((index, element) => {\n                var $wrap,\n                    $catId = $(element).data('category-id'),\n                    $catUrl = $(element).data('category-url'),\n                    $blockId = $(element).attr('id');\n\n                if($(element).find('.productByCate').length > 0){\n                    $wrap = $(element).find('.productByCate');\n                    $options = {\n                        template: 'halothemes/sidebar/halo-product-sidebar-tmp-2'\n                    };\n                }\n\n                if(!$('#product-by-cate-'+$catId+' .productByCate .card').length){\n                    loadCategory($catId, $catUrl, $options, $wrap, $blockId);\n                }\n            });\n        }\n\n        function loadCategory(id, url, option, wrap, blockId){\n            utils.api.getPage(url, option, (err, response) => {\n                wrap.html(response);\n                \n                wrap.parents('.sidebarBlock[data-category-id]').find('.loadingOverlay').remove();\n\n                haloAddOptionForProduct(context, blockId);\n            }); \n        }\n    }\n\n    loadProductByEditorPick(){\n        const context = this.context;\n\n        var $options;\n\n        if($('.sidebarBlock[data-list-id]').length > 0){\n            $('.sidebarBlock[data-list-id]').each((index, element) => {\n                var $prodWrapId = $(element).attr('id'),\n                    $wrap,\n                    $listId = $(element).data('list-id');\n\n                if($(element).find('.productById').length > 0){\n                    $wrap = $(element).find('.productById');\n                    $options = {\n                        template: 'halothemes/sidebar/halo-product-sidebar-tmp-3'\n                    };\n                }\n\n                if(!$('#product-by-list-'+$prodWrapId+' .productById .card').length){\n                    loadListID($listId, $options, $wrap, $prodWrapId);\n                }\n            });\n        }\n\n        function loadListID(id, options, wrap, blockId){\n            var arr = id.toString().split(',').map(Number),\n                list = arr.slice(0,parseInt(context.themeSettings.sidebar_products_per_page)),\n                num = 0;\n\n            for (var i = 0; i <= list.length; i++) {\n                var $prodId = list[i];\n\n                if($prodId != undefined){\n                    utils.api.product.getById($prodId, options, (err, response) => {\n                        wrap.append(response);\n\n                        num++;\n\n                        if(num == list.length){\n                            haloAddOptionForProduct(context, blockId);\n                            wrap.parents('.sidebarBlock[data-list-id]').find('.loadingOverlay').remove();\n                            return;\n                        }\n                    });            \n                }\n            }\n        }\n    }\n\n    initValidation($form) {\n        this.$form = $form;\n        this.validator = nod({\n            submit: $form,\n            tap: announceInputErrorMessage,\n        });\n\n        return this;\n    }\n\n    bindValidation($element) {\n        if (this.validator) {\n            this.validator.add({\n                selector: $element,\n                validate: 'presence',\n                errorMessage: $element.data('errorMessage'),\n            });\n        }\n\n        return this;\n    }\n\n    check() {\n        if (this.validator) {\n            this.validator.performCheck();\n            return this.validator.areAll('valid');\n        }\n\n        return false;\n    }\n}\n"],"names":["Search","_CatalogPage","apply","arguments","_proto","prototype","formatCategoryTreeForJSTree","node","_this","nodeData","text","data","id","metadata","state","selected","opened","children","forEach","childNode","push","showProducts","navigate","this","$productListingContainer","removeClass","$facetedSearchContainer","$contentResultsContainer","addClass","$","parent","siblings","activateTab","searchData","url","count","urlUtils","replaceParams","page","goToUrl","showContent","$tabToActivate","find","each","idx","tab","$tab","is","removeAttr","attr","onTabChangeWithArrows","event","eventKey","which","$tabsCollection","index","document","activeElement","nextTabIdx","$activeTab","activeTabIdx","lastTabIdx","length","get","focus","trigger","onReady","_this2","compareProducts","context","arrangeFocusOnSortBy","$searchForm","$categoryTreeContainer","Url","window","location","href","treeData","initFacetedSearch","onSortBySubmit","bind","hooks","on","collapsibleFactory","preventDefault","query","section","validator","initValidation","bindValidation","categoryTree","categoryTreeData","createCategoryTree","selectedCategoryIds","jstree","get_selected","check","remove","_step","_iterator","_createForOfIteratorHelperLoose","done","categoryId","value","input","type","name","append","$searchResultsMessage","searchResultsCount","prependTo","setTimeout","haloSideAllCategory","haloproductDisplayMode","haloSidebarToggle","haloStickyToolbar","loadProductByCategory","loadProductByEditorPick","loadOptionForProductCard","showProductsPerPage","showMoreProducts","showPaginationInfoToolbar","showItem","loadTreeNodes","cb","_this3","ajax","selectedCategoryId","prefix","headers","BCData","csrf_token","formattedResults","dataNode","$container","_this4","treeOptions","core","themes","icons","checkbox","three_state","plugins","_this5","_this$context","onMinPriceError","onMaxPriceError","minPriceNotEntered","maxPriceNotEntered","onInvalidPrice","$contentListingContainer","$searchHeading","$searchCount","$contentCount","$showMoreContainer","requestOptions","template","productListing","contentListing","sidebar","heading","productCount","contentCount","paginator","config","product_results","limit","searchProductsPerPage","showMore","facetedSearch","FacetedSearch","content","html","haloAddOptionForProduct","triggerHandler","animate","scrollTop","$topProduct","slick","validationErrorMessages","c","URL","searchParams","querySelectorAll","Array","call","element","e","productPerPage","total","parseInt","getUrlParameter","undefined","start","end","checkLastPage","lastPage","checkLink","next","totalNotLast","productsLastPage","currentPage","prevPage","showPaginationTotalProgress","sParam","sParameterName","i","sURLVariables","decodeURIComponent","search","substring","split","_this6","shop_by_price","products","$paginatorContainer","nextPage","link","hasClass","api","getPage","replace","err","Error","blur","pageCurrent","paginationInfo","txt_end","txt_total","num_end","Number","num_total","percent","css","$options","$wrap","option","wrap","blockId","$catId","$catUrl","$blockId","utils","response","parents","$prodWrapId","$listId","options","list","toString","map","slice","themeSettings","sidebar_products_per_page","num","$prodId","product","getById","loadListID","$form","nod","submit","tap","announceInputErrorMessage","$element","add","selector","validate","errorMessage","performCheck","areAll","CatalogPage"],"sourceRoot":""}
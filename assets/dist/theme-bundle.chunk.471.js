"use strict";(self.webpackChunkbigcommerce_hera=self.webpackChunkbigcommerce_hera||[]).push([[471],{30471:(t,e,a)=>{a.r(e),a.d(e,{default:()=>C});var r=a(59076),n=a(57792),o=a(13228),i=a(96609),s=a(71305),c=a(56526),d=a(88835),l=a(65117),u=(a(77462),a(41582)),h=a(48240),p=a(76970),g=a(80156),f=a(12946),m=a(42240),v=a(33270);function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=Array(e);a<e;a++)r[a]=t[a];return r}function y(t,e){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},y(t,e)}var C=function(t){function e(){return t.apply(this,arguments)||this}var a,n;n=t,(a=e).prototype=Object.create(n.prototype),a.prototype.constructor=a,y(a,n);var C=e.prototype;return C.formatCategoryTreeForJSTree=function(t){var e=this,a={text:t.data,id:t.metadata.id,state:{selected:t.selected}};return t.state&&(a.state.opened="open"===t.state,a.children=!0),t.children&&(a.children=[],t.children.forEach((function(t){a.children.push(e.formatCategoryTreeForJSTree(t))}))),a},C.showProducts=function(t){if(void 0===t&&(t=!0),this.$productListingContainer.removeClass("u-hidden"),this.$facetedSearchContainer.removeClass("u-hidden"),this.$contentResultsContainer.addClass("u-hidden"),v("[data-content-results-toggle]").removeClass("navBar-action-color--active").addClass("navBar-action"),v("[data-product-results-toggle]").removeClass("navBar-action").addClass("navBar-action-color--active"),v("[data-product-results-toggle]").parent(".navBar-item").addClass("navBar-item--active"),v("[data-product-results-toggle]").parent(".navBar-item").siblings().removeClass("navBar-item--active"),this.activateTab(v("[data-product-results-toggle]")),t){var e=v("#search-results-product-count span").data(),a=e.count>0?e.url:c.A.replaceParams(e.url,{page:1});c.A.goToUrl(a)}},C.showContent=function(t){if(void 0===t&&(t=!0),this.$contentResultsContainer.removeClass("u-hidden"),this.$productListingContainer.addClass("u-hidden"),this.$facetedSearchContainer.addClass("u-hidden"),v("[data-product-results-toggle]").removeClass("navBar-action-color--active").addClass("navBar-action"),v("[data-content-results-toggle]").removeClass("navBar-action").addClass("navBar-action-color--active"),v("[data-content-results-toggle]").parent(".navBar-item").addClass("navBar-item--active"),v("[data-content-results-toggle]").parent(".navBar-item").siblings().removeClass("navBar-item--active"),this.activateTab(v("[data-content-results-toggle]")),t){var e=v("#search-results-content-count span").data(),a=e.count>0?e.url:c.A.replaceParams(e.url,{page:1});c.A.goToUrl(a)}},C.activateTab=function(t){v("[data-search-page-tabs]").find('[role="tab"]').each((function(e,a){var r=v(a);if(r.is(t))return r.removeAttr("tabindex"),void r.attr("aria-selected",!0);r.attr("tabindex","-1"),r.attr("aria-selected",!1)}))},C.onTabChangeWithArrows=function(t){var e=t.which;if(37===e||39===e){var a=v("[data-search-page-tabs]").find('[role="tab"]');if(-1!==a.index(v(document.activeElement))){var r,n=v("#"+document.activeElement.id),o=a.index(n),i=a.length-1;switch(e){case 37:r=0===o?i:o-1;break;case 39:r=o===i?0:o+1}v(a.get(r)).focus().trigger("click")}}},C.onReady=function(){var t=this;(0,s.A)(this.context),this.arrangeFocusOnSortBy();var e=v("[data-advanced-search-form]"),a=e.find("[data-search-category-tree]"),n=d.parse(window.location.href,!0),o=[];this.$productListingContainer=v("#product-listing-container"),this.$facetedSearchContainer=v("#faceted-search-container"),this.$contentResultsContainer=v("#search-results-content"),v("#facetedSearch").length>0?this.initFacetedSearch():(this.onSortBySubmit=this.onSortBySubmit.bind(this),r.JL.on("sortBy-submitted",this.onSortBySubmit)),(0,l.Ay)(),v("[data-product-results-toggle]").on("click",(function(e){e.preventDefault(),t.showProducts()})),v("[data-content-results-toggle]").on("click",(function(e){e.preventDefault(),t.showContent()})),v("[data-search-page-tabs]").on("keyup",this.onTabChangeWithArrows),0===this.$productListingContainer.find("li.product").length||"content"===n.query.section?this.showContent(!1):this.showProducts(!1);var i=this.initValidation(e).bindValidation(e.find("#search_query_adv"));this.context.categoryTree.forEach((function(e){o.push(t.formatCategoryTreeForJSTree(e))})),this.categoryTreeData=o,this.createCategoryTree(a),e.on("submit",(function(t){var r=a.jstree().get_selected();if(!i.check())return t.preventDefault();e.find('input[name="category[]"]').remove();for(var n,o=function(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(a)return(a=a.call(t)).next.bind(a);if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return b(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?b(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(r);!(n=o()).done;){var s=n.value,c=v("<input>",{type:"hidden",name:"category[]",value:s});e.append(c)}}));var c=v('<p\n            class="aria-description--hidden"\n            tabindex="-1"\n            role="status"\n            aria-live="polite"\n            >'+this.context.searchResultsCount+"</p>").prependTo("body");setTimeout((function(){return c.focus()}),100),(0,h.A)(),(0,g.A)(),(0,f.A)(),(0,m.A)(this.context),this.loadProductByCategory(),this.loadProductByEditorPick(),this.loadOptionForProductCard(this.context),this.showProductsPerPage(),this.showMoreProducts(),this.showPaginationInfoToolbar(),this.showItem()},C.loadTreeNodes=function(t,e){var a=this;v.ajax({url:"/remote/v1/category-tree",data:{selectedCategoryId:t.id,prefix:"category"},headers:{"x-xsrf-token":window.BCData&&window.BCData.csrf_token?window.BCData.csrf_token:""}}).done((function(t){var r=[];t.forEach((function(t){r.push(a.formatCategoryTreeForJSTree(t))})),e(r)}))},C.createCategoryTree=function(t){var e=this,a={core:{data:function(t,a){"#"===t.id?a(e.categoryTreeData):e.loadTreeNodes(t,a)},themes:{icons:!0}},checkbox:{three_state:!1},plugins:["checkbox"]};t.jstree(a)},C.initFacetedSearch=function(){var t=this,e=this.context,a=e.onMinPriceError,r=e.onMaxPriceError,n=e.minPriceNotEntered,i=e.maxPriceNotEntered,s=e.onInvalidPrice,c=v("#product-listing-container"),l=v("#search-results-content"),u=v("#faceted-search-container"),h=v("#search-results-heading"),g=v("#search-results-product-count"),f=v("#search-results-content-count"),m=v(".halo-product-show-more"),b={template:{productListing:"search/product-listing",contentListing:"search/content-listing",sidebar:"search/sidebar",heading:"search/heading",productCount:"search/product-count",contentCount:"search/content-count",paginator:"halothemes/gallery/halo-product-paginator"},config:{product_results:{limit:this.context.searchProductsPerPage}},showMore:"search/show-more"};this.facetedSearch=new o.A(b,(function(e){h.html(e.heading),"content"===d.parse(window.location.href,!0).query.section?(l.html(e.contentListing),f.html(e.contentCount),t.showContent(!1)):(c.find(".product-listing-content").html(e.productListing),u.html(e.sidebar),g.html(e.productCount),m.html(v(e.paginator).find(".halo-product-show-more").children()),t.showProducts(!1),t.showProductsPerPage(),t.showMoreProducts(),t.showPaginationInfoToolbar(),t.showItem(),v("#product-listing-container .product").length>0&&(0,p.A)(t.context,"product-listing-container")),v("body").triggerHandler("compareReset"),v("html, body").animate({scrollTop:0},100);var a=v("#faceted-search-container #featured-products .products-list");a.length&&a.slick()}),{validationErrorMessages:{onMinPriceError:a,onMaxPriceError:r,minPriceNotEntered:n,maxPriceNotEntered:i,onInvalidPrice:s}})},C.loadOptionForProductCard=function(t){v("#featured-products .card").length>0&&(0,p.A)(t,"featured-products"),v("#product-listing-container .product").length>0&&(0,p.A)(t,"product-listing-container")},C.showProductsPerPage=function(){try{var t=new URL(window.location.href).searchParams.get("limit");if(null!=t){var e=document.querySelectorAll("select#limit option");Array.prototype.forEach.call(e,(function(e){e.value==t&&(e.selected=!0)}))}}catch(t){}},C.showItem=function(){var t,e=parseInt(v(".pagination-info .total").text()),a=this.getUrlParameter("limit");t=void 0!==a?a:this.context.searchProductsPerPage;var r=1,n=e,o=!1,i=1,s=v(".pagination-list .pagination-item--current").next(),c=(i-1)*t,d=e-c,l=parseInt(v(".pagination-item--current > a").text()),u=l-1;0===s.length?(i=parseInt(v(".pagination-item--current").find("a").text()),o=!0):(i=parseInt(s.find("a").text()),o=!1),e<=t?(v(".pagination-info .start").text(r),v(".pagination-info .end").text(n)):(l<=1?n=t:(r=u*t+1,n=1==o?v(".pagination-list .pagination-item--next").length>0?c+d-1:c+d:l*t),v(".pagination-info .start").text(r),v(".pagination-info .end").text(n)),this.showPaginationTotalProgress()},C.getUrlParameter=function(t){var e,a,r=decodeURIComponent(window.location.search.substring(1)).split("&");for(a=0;a<r.length;a++)if((e=r[a].split("="))[0]===t)return void 0===e[1]||e[1]},C.showMoreProducts=function(){var t=this,e=this.context,a=this.getUrlParameter("limit"),n={config:{product_results:{shop_by_price:!0,products:{limit:e.searchProductsPerPage}}},template:{productListing:"search/halo-product-listing",sidebar:"search/sidebar",paginator:"halothemes/gallery/halo-product-paginator"},showMore:"search/show-more"},o=v("#product-listing-container .productListing"),i=(v("#faceted-search-container"),v(".pagination-list"));v(".halo-product-show-more"),v("#listing-showmoreBtn > a").on("click",(function(s){s.preventDefault();var c=v(".pagination-item--current").next(),d=c.find("a").attr("href");null==d?v("#listing-showmoreBtn > a").hasClass("disable")||v("#listing-showmoreBtn > a").addClass("disable"):(v("#listing-showmoreBtn > a").addClass("loading"),r.FH.getPage(d.replace("http://","//"),n,(function(r,n){if(r)throw new Error(r);if(""!=n.productListing){if(o.append(n.productListing),i.html(v(n.paginator).find(".pagination-list").children()),v("#listing-showmoreBtn > a").removeClass("loading").blur(),0===(c=v(".pagination-item--current").next()).length)v("#listing-showmoreBtn > a").addClass("disable").text("No more products"),v(".pagination .pagination-info .end").text(v(".toolbar-left .pagination-info .total").text());else{var s,d=a,l=parseInt(v(".pagination-item--current > a").text());s=void 0!==d?d:e.searchProductsPerPage;var u=parseInt(s)*l;v(".pagination .pagination-info .end").text(u)}var h=v(".pagination .pagination-info").html();v(".toolbar-wrapper .toolbar-left .pagination-info").html(h),t.showPaginationTotalProgress(),(0,p.A)(e,"product-listing-container")}})))}))},C.showPaginationTotalProgress=function(){var t=v(".pagination-info .end").text(),e=v(".pagination-info .total").text(),a=""!=a?Number(t.replace(/[^0-9.-]+/g,"")):0,r=""!=r?Number(e.replace(/[^0-9.-]+/g,"")):0,n=parseInt(a/r*100);n=n>100?100:n,a==r&&(n=100),v(".pagination-total-progress .pagination-total-item").css("width",n+"%")},C.showPaginationInfoToolbar=function(){var t=v(".pagination .pagination-info").html();v(".toolbar-wrapper .toolbar-left .pagination-info").html(t)},C.loadProductByCategory=function(){var t,e=this.context;v(".sidebarBlock[data-category-id]").length>0&&v(".sidebarBlock[data-category-id]").each((function(a,n){var o,i,s,c,d,l=v(n).data("category-id"),u=v(n).data("category-url"),h=v(n).attr("id");v(n).find(".productByCate").length>0&&(o=v(n).find(".productByCate"),t={template:"halothemes/sidebar/halo-product-sidebar-tmp-2"}),v("#product-by-cate-"+l+" .productByCate .card").length||(i=u,s=t,c=o,d=h,r.Ay.api.getPage(i,s,(function(t,a){c.html(a),c.parents(".sidebarBlock[data-category-id]").find(".loadingOverlay").remove(),(0,p.A)(e,d)})))}))},C.loadProductByEditorPick=function(){var t,e=this.context;v(".sidebarBlock[data-list-id]").length>0&&v(".sidebarBlock[data-list-id]").each((function(a,n){var o,i=v(n).attr("id"),s=v(n).data("list-id");v(n).find(".productById").length>0&&(o=v(n).find(".productById"),t={template:"halothemes/sidebar/halo-product-sidebar-tmp-3"}),v("#product-by-list-"+i+" .productById .card").length||function(t,a,n,o){for(var i=t.toString().split(",").map(Number).slice(0,parseInt(e.themeSettings.sidebar_products_per_page)),s=0,c=0;c<=i.length;c++){var d=i[c];null!=d&&r.Ay.api.product.getById(d,a,(function(t,a){if(n.append(a),++s==i.length)return(0,p.A)(e,o),void n.parents(".sidebarBlock[data-list-id]").find(".loadingOverlay").remove()}))}}(s,t,o,i)}))},C.initValidation=function(t){return this.$form=t,this.validator=(0,u.A)({submit:t,tap:i.dN}),this},C.bindValidation=function(t){return this.validator&&this.validator.add({selector:t,validate:"presence",errorMessage:t.data("errorMessage")}),this},C.check=function(){return!!this.validator&&(this.validator.performCheck(),this.validator.areAll("valid"))},e}(n.A)}}]);
//# sourceMappingURL=theme-bundle.chunk.471.js.map